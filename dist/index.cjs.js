"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react/jsx-runtime"),t=require("react");const a=e=>e.replace(/[<>/'"\\]/g,""),s=e=>e.replace(/[^a-zA-Z0-9@._-]/g,""),l=(e,t)=>{if(!/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(e))return"Invalid email format";if(t&&t.length>0){const a=e.split("@")[1];if(!t.includes(a))return`Allowed domains: ${t.join(", ")}`}return""},r=e=>e.replace(/\s/g,"");exports.SecureCopyButton=({text:a,className:s="",buttonText:l="Copy",copiedText:r="Copied!",maskText:n=!1,autoClearClipboard:o=!1,clearTimeoutMs:i=3e3})=>{const[u,c]=t.useState(!1);return e.jsxs("div",{className:`relative ${s}`,children:[e.jsx("span",{className:"mr-2",children:n?"••••••••••":a}),e.jsx("button",{type:"button",onClick:async()=>{try{await navigator.clipboard.writeText(a),c(!0),o?setTimeout((async()=>{await navigator.clipboard.writeText(""),c(!1)}),i):setTimeout((()=>c(!1)),1500)}catch(e){console.error("Failed to copy text:",e)}},className:"p-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:u?r:l})]})},exports.SecureEmailInput=({value:a="",onChange:r,sanitize:n=s,validateEmail:o=l,placeholder:i="Enter email...",className:u="",allowedDomains:c=[]})=>{const[d,p]=t.useState(a),[m,h]=t.useState("");return e.jsxs("div",{className:`relative w-full ${u}`,children:[e.jsx("input",{type:"email",value:d,onChange:e=>{let t=n(e.target.value.trim().toLowerCase());p(t);const a=o(t,c);h(a),a||r?.(t)},placeholder:i,className:"w-full p-2 border rounded"}),m&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:m})]})},exports.SecurePasswordInput=({value:a="",onChange:s,minLength:l=8,maxLength:n=64,sanitize:o=r,placeholder:i="Enter password...",className:u="",showStrengthMeter:c=!0,preventPaste:d=!1})=>{const[p,m]=t.useState(a),[h,x]=t.useState(!1),g=(e=>{let t=0;return e.length>=8&&t++,/[A-Z]/.test(e)&&t++,/[a-z]/.test(e)&&t++,/[0-9]/.test(e)&&t++,/[@$!%*?&#]/.test(e)&&t++,t})(p);return e.jsxs("div",{className:`relative w-full ${u}`,children:[e.jsx("input",{type:h?"text":"password",value:p,onChange:e=>{let t=o(e.target.value);t=t.slice(0,n),m(t),s?.(t)},placeholder:i,className:"w-full p-2 border rounded",minLength:l,maxLength:n,onPaste:d?e=>e.preventDefault():void 0}),e.jsx("button",{type:"button",className:"absolute right-2 top-2 text-gray-500",onClick:()=>x((e=>!e)),children:h?"🙈":"👁️"}),c&&e.jsx("div",{className:"mt-2 w-full h-2 bg-gray-300 rounded",children:e.jsx("div",{className:"h-full "+(5===g?"bg-green-500":g>=3?"bg-yellow-500":"bg-red-500"),style:{width:g/5*100+"%"}})})]})},exports.SecureTextInput=({value:s="",onChange:l,allowedChars:r=/^[a-zA-Z0-9\s]*$/,maxLength:n=255,sanitize:o=a,placeholder:i="Enter text...",className:u="",id:c})=>{const[d,p]=t.useState(s),m=t.useRef(null);t.useEffect((()=>{p(s)}),[s]);return e.jsx("input",{ref:m,type:"text",value:d,onChange:e=>{let t=e.target.value;t=t.split("").filter((e=>r.test(e))).join(""),t=o(t).slice(0,n),t!==d&&(p(t),l?.(t))},placeholder:i,className:u,id:c,"aria-label":i})};
//# sourceMappingURL=index.cjs.js.map
