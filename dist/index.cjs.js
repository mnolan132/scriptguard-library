"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react/jsx-runtime"),t=require("react");const a=e=>e.replace(/[<>/'"\\]/g,""),r=e=>e.replace(/[^a-zA-Z0-9@._-]/g,""),s=(e,t)=>{if(!/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(e))return"Invalid email format";if(t&&t.length>0){const a=e.split("@")[1];if(!t.includes(a))return`Allowed domains: ${t.join(", ")}`}return""},n=e=>e.replace(/\s/g,""),l=({value:a="",onChange:r,minLength:s=8,maxLength:l=64,sanitize:o=n,placeholder:i="Enter password...",className:u="",showStrengthMeter:c=!0,preventPaste:h=!1})=>{const d=a||"",[p,m]=t.useState(!1),x=(e=>{let t=0;return e.length>=8&&t++,/[A-Z]/.test(e)&&t++,/[a-z]/.test(e)&&t++,/[0-9]/.test(e)&&t++,/[@$!%*?&#]/.test(e)&&t++,t})(d);return e.jsxs("div",{className:`relative w-full ${u}`,children:[e.jsx("input",{type:p?"text":"password",value:d,onChange:e=>{let t=o(e.target.value);t=t.slice(0,l),r?.(t)},placeholder:i,className:"w-full p-2 border rounded",minLength:s,maxLength:l,onPaste:h?e=>e.preventDefault():void 0}),e.jsx("button",{type:"button",className:"absolute right-2 top-2 text-gray-500",onClick:()=>m((e=>!e)),children:p?"ðŸ™ˆ":"ðŸ‘ï¸"}),c&&e.jsx("div",{className:"mt-2 w-full h-2 bg-gray-300 rounded",children:e.jsx("div",{className:"h-full "+(5===x?"bg-green-500":x>=3?"bg-yellow-500":"bg-red-500"),style:{width:x/5*100+"%"}})})]})};exports.PasswordGenerator=({minLength:a=12,maxLength:r=20,onGenerate:s,showStrengthMeter:n=!0})=>{const[o,i]=t.useState("");return e.jsxs("div",{children:[e.jsx(l,{value:o,onChange:i,minLength:a,maxLength:r,showStrengthMeter:n}),e.jsx("button",{type:"button",onClick:()=>{const e=((e,t={upper:!0,lower:!0,numbers:!0,symbols:!0})=>{const a="ABCDEFGHIJKLMNOPQRSTUVWXYZ",r="abcdefghijklmnopqrstuvwxyz",s="0123456789",n="!@#$%^&*()_+-=[]{}|;:,.<>?",l=[],o=[];t.upper&&(l.push(a),o.push(a[Math.floor(26*Math.random())])),t.lower&&(l.push(r),o.push(r[Math.floor(26*Math.random())])),t.numbers&&(l.push(s),o.push(s[Math.floor(10*Math.random())])),t.symbols&&(l.push(n),o.push(n[Math.floor(26*Math.random())]));const i=l.join("");if(!i)return"";const u=Math.max(e-o.length,0),c=[];for(let e=0;e<u;e++)c.push(i[Math.floor(Math.random()*i.length)]);const h=[...o,...c];for(let e=h.length-1;e>0;e--){const t=Math.floor(Math.random()*(e+1));[h[e],h[t]]=[h[t],h[e]]}return h.join("")})(a);i(e),s?.(e)},children:"Generate Password"})]})},exports.SecureCopyButton=({text:a,className:r="",buttonText:s="Copy",copiedText:n="Copied!",maskText:l=!1,autoClearClipboard:o=!1,clearTimeoutMs:i=3e3})=>{const[u,c]=t.useState(!1);return e.jsxs("div",{className:`relative ${r}`,children:[e.jsx("span",{className:"mr-2",children:l?"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢":a}),e.jsx("button",{type:"button",onClick:async()=>{try{await navigator.clipboard.writeText(a),c(!0),o?setTimeout((async()=>{await navigator.clipboard.writeText(""),c(!1)}),i):setTimeout((()=>c(!1)),1500)}catch(e){console.error("Failed to copy text:",e)}},className:"p-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:u?n:s})]})},exports.SecureEmailInput=({value:a="",onChange:n,sanitize:l=r,validateEmail:o=s,placeholder:i="Enter email...",className:u="",allowedDomains:c=[]})=>{const[h,d]=t.useState(a),[p,m]=t.useState("");return e.jsxs("div",{className:`relative w-full ${u}`,children:[e.jsx("input",{type:"email",value:h,onChange:e=>{let t=l(e.target.value.trim().toLowerCase());d(t);const a=o(t,c);m(a),a||n?.(t)},placeholder:i,className:"w-full p-2 border rounded"}),p&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:p})]})},exports.SecurePasswordInput=l,exports.SecureTextInput=({value:r="",onChange:s,allowedChars:n=/^[a-zA-Z0-9\s]*$/,maxLength:l=255,sanitize:o=a,placeholder:i="Enter text...",className:u="",id:c})=>{const[h,d]=t.useState(r),p=t.useRef(null);t.useEffect((()=>{d(r)}),[r]);return e.jsx("input",{ref:p,type:"text",value:h,onChange:e=>{let t=e.target.value;t=t.split("").filter((e=>n.test(e))).join(""),t=o(t).slice(0,l),t!==h&&(d(t),s?.(t))},placeholder:i,className:u,id:c,"aria-label":i})};
//# sourceMappingURL=index.cjs.js.map
