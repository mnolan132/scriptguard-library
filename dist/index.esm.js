import{jsx as e,jsxs as t}from"react/jsx-runtime";import{useState as a,useRef as l,useEffect as r}from"react";const n=e=>e.replace(/[<>/'"\\]/g,""),s=({value:t="",onChange:s,allowedChars:i=/^[a-zA-Z0-9\s]*$/,maxLength:o=255,sanitize:c=n,placeholder:d="Enter text...",className:u="",id:m})=>{const[p,h]=a(t),g=l(null);r((()=>{h(t)}),[t]);return e("input",{ref:g,type:"text",value:p,onChange:e=>{let t=e.target.value;t=t.split("").filter((e=>i.test(e))).join(""),t=c(t).slice(0,o),t!==p&&(h(t),s?.(t))},placeholder:d,className:u,id:m,"aria-label":d})},i=e=>e.replace(/[^a-zA-Z0-9@._-]/g,""),o=(e,t)=>{if(!/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(e))return"Invalid email format";if(t&&t.length>0){const a=e.split("@")[1];if(!t.includes(a))return`Allowed domains: ${t.join(", ")}`}return""},c=({value:l="",onChange:r,sanitize:n=i,validateEmail:s=o,placeholder:c="Enter email...",className:d="",allowedDomains:u=[]})=>{const[m,p]=a(l),[h,g]=a("");return t("div",{className:`relative w-full ${d}`,children:[e("input",{type:"email",value:m,onChange:e=>{let t=n(e.target.value.trim().toLowerCase());p(t);const a=s(t,u);g(a),a||r?.(t)},placeholder:c,className:"w-full p-2 border rounded"}),h&&e("p",{className:"text-red-500 text-sm mt-1",children:h})]})},d=e=>e.replace(/\s/g,""),u=({value:l="",onChange:r,minLength:n=8,maxLength:s=64,sanitize:i=d,placeholder:o="Enter password...",className:c="",showStrengthMeter:u=!0,preventPaste:m=!1})=>{const[p,h]=a(l),[g,v]=a(!1),b=(e=>{let t=0;return e.length>=8&&t++,/[A-Z]/.test(e)&&t++,/[a-z]/.test(e)&&t++,/[0-9]/.test(e)&&t++,/[@$!%*?&#]/.test(e)&&t++,t})(p);return t("div",{className:`relative w-full ${c}`,children:[e("input",{type:g?"text":"password",value:p,onChange:e=>{let t=i(e.target.value);t=t.slice(0,s),h(t),r?.(t)},placeholder:o,className:"w-full p-2 border rounded",minLength:n,maxLength:s,onPaste:m?e=>e.preventDefault():void 0}),e("button",{type:"button",className:"absolute right-2 top-2 text-gray-500",onClick:()=>v((e=>!e)),children:g?"🙈":"👁️"}),u&&e("div",{className:"mt-2 w-full h-2 bg-gray-300 rounded",children:e("div",{className:"h-full "+(5===b?"bg-green-500":b>=3?"bg-yellow-500":"bg-red-500"),style:{width:b/5*100+"%"}})})]})},m=({text:l,className:r="",buttonText:n="Copy",copiedText:s="Copied!",maskText:i=!1,autoClearClipboard:o=!1,clearTimeoutMs:c=3e3})=>{const[d,u]=a(!1);return t("div",{className:`relative ${r}`,children:[e("span",{className:"mr-2",children:i?"••••••••••":l}),e("button",{type:"button",onClick:async()=>{try{await navigator.clipboard.writeText(l),u(!0),o?setTimeout((async()=>{await navigator.clipboard.writeText(""),u(!1)}),c):setTimeout((()=>u(!1)),1500)}catch(e){console.error("Failed to copy text:",e)}},className:"p-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:d?s:n})]})};export{m as SecureCopyButton,c as SecureEmailInput,u as SecurePasswordInput,s as SecureTextInput};
//# sourceMappingURL=index.esm.js.map
