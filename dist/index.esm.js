import{jsx as e,jsxs as t}from"react/jsx-runtime";import{useState as a,useRef as r,useEffect as l}from"react";const n=e=>e.replace(/[<>/'"\\]/g,""),o=({value:t="",onChange:o,allowedChars:s=/^[a-zA-Z0-9\s]*$/,maxLength:i=255,sanitize:h=n,placeholder:c="Enter text...",className:u="",id:d})=>{const[m,p]=a(t),g=r(null);l((()=>{p(t)}),[t]);return e("input",{ref:g,type:"text",value:m,onChange:e=>{let t=e.target.value;t=t.split("").filter((e=>s.test(e))).join(""),t=h(t).slice(0,i),t!==m&&(p(t),o?.(t))},placeholder:c,className:u,id:d,"aria-label":c})},s=e=>e.replace(/[^a-zA-Z0-9@._-]/g,""),i=(e,t)=>{if(!/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(e))return"Invalid email format";if(t&&t.length>0){const a=e.split("@")[1];if(!t.includes(a))return`Allowed domains: ${t.join(", ")}`}return""},h=({value:r="",onChange:l,sanitize:n=s,validateEmail:o=i,placeholder:h="Enter email...",className:c="",allowedDomains:u=[]})=>{const[d,m]=a(r),[p,g]=a("");return t("div",{className:`relative w-full ${c}`,children:[e("input",{type:"email",value:d,onChange:e=>{let t=n(e.target.value.trim().toLowerCase());m(t);const a=o(t,u);g(a),a||l?.(t)},placeholder:h,className:"w-full p-2 border rounded"}),p&&e("p",{className:"text-red-500 text-sm mt-1",children:p})]})},c=e=>e.replace(/\s/g,""),u=({value:r="",onChange:l,minLength:n=8,maxLength:o=64,sanitize:s=c,placeholder:i="Enter password...",className:h="",showStrengthMeter:u=!0,preventPaste:d=!1})=>{const m=r||"",[p,g]=a(!1),v=(e=>{let t=0;return e.length>=8&&t++,/[A-Z]/.test(e)&&t++,/[a-z]/.test(e)&&t++,/[0-9]/.test(e)&&t++,/[@$!%*?&#]/.test(e)&&t++,t})(m);return t("div",{className:`relative w-full ${h}`,children:[e("input",{type:p?"text":"password",value:m,onChange:e=>{let t=s(e.target.value);t=t.slice(0,o),l?.(t)},placeholder:i,className:"w-full p-2 border rounded",minLength:n,maxLength:o,onPaste:d?e=>e.preventDefault():void 0}),e("button",{type:"button",className:"absolute right-2 top-2 text-gray-500",onClick:()=>g((e=>!e)),children:p?"🙈":"👁️"}),u&&e("div",{className:"mt-2 w-full h-2 bg-gray-300 rounded",children:e("div",{className:"h-full "+(5===v?"bg-green-500":v>=3?"bg-yellow-500":"bg-red-500"),style:{width:v/5*100+"%"}})})]})},d=({text:r,className:l="",buttonText:n="Copy",copiedText:o="Copied!",maskText:s=!1,autoClearClipboard:i=!1,clearTimeoutMs:h=3e3})=>{const[c,u]=a(!1);return t("div",{className:`relative ${l}`,children:[e("span",{className:"mr-2",children:s?"••••••••••":r}),e("button",{type:"button",onClick:async()=>{try{await navigator.clipboard.writeText(r),u(!0),i?setTimeout((async()=>{await navigator.clipboard.writeText(""),u(!1)}),h):setTimeout((()=>u(!1)),1500)}catch(e){console.error("Failed to copy text:",e)}},className:"p-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:c?o:n})]})},m=({minLength:r=12,maxLength:l=20,onGenerate:n,showStrengthMeter:o=!0})=>{const[s,i]=a("");return t("div",{children:[e(u,{value:s,onChange:i,minLength:r,maxLength:l,showStrengthMeter:o}),e("button",{type:"button",onClick:()=>{const e=((e,t={upper:!0,lower:!0,numbers:!0,symbols:!0})=>{const a="ABCDEFGHIJKLMNOPQRSTUVWXYZ",r="abcdefghijklmnopqrstuvwxyz",l="0123456789",n="!@#$%^&*()_+-=[]{}|;:,.<>?",o=[],s=[];t.upper&&(o.push(a),s.push(a[Math.floor(26*Math.random())])),t.lower&&(o.push(r),s.push(r[Math.floor(26*Math.random())])),t.numbers&&(o.push(l),s.push(l[Math.floor(10*Math.random())])),t.symbols&&(o.push(n),s.push(n[Math.floor(26*Math.random())]));const i=o.join("");if(!i)return"";const h=Math.max(e-s.length,0),c=[];for(let e=0;e<h;e++)c.push(i[Math.floor(Math.random()*i.length)]);const u=[...s,...c];for(let e=u.length-1;e>0;e--){const t=Math.floor(Math.random()*(e+1));[u[e],u[t]]=[u[t],u[e]]}return u.join("")})(r);i(e),n?.(e)},children:"Generate Password"})]})};export{m as PasswordGenerator,d as SecureCopyButton,h as SecureEmailInput,u as SecurePasswordInput,o as SecureTextInput};
//# sourceMappingURL=index.esm.js.map
